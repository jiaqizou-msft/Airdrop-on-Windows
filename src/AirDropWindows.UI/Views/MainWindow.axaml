<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AirDropWindows.UI.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
        x:Class="AirDropWindows.UI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="AirDrop for Windows"
        Width="900" Height="600"
        MinWidth="700" MinHeight="500">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="20,15">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0">
                    <TextBlock Text="AirDrop for Windows"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock Text="Share files with nearby Apple devices"
                               FontSize="12"
                               Foreground="#BDC3C7"
                               Margin="0,5,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                    <Button Content="Start Discovery"
                            Command="{Binding StartDiscoveryCommand}"
                            IsEnabled="{Binding !IsDiscovering}"
                            Padding="15,8"/>
                    <Button Content="Stop Discovery"
                            Command="{Binding StopDiscoveryCommand}"
                            IsEnabled="{Binding IsDiscovering}"
                            Padding="15,8"/>
                    <Button Content="Refresh"
                            Command="{Binding RefreshDevicesCommand}"
                            Padding="15,8"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" ColumnDefinitions="2*,*" Margin="20">
            <!-- Device List -->
            <Border Grid.Column="0"
                    BorderBrush="#BDC3C7"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="15"
                    Margin="0,0,10,0">
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0"
                               Text="Nearby Devices"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Margin="0,0,0,15"/>

                    <ScrollViewer Grid.Row="1">
                        <ItemsControl ItemsSource="{Binding DiscoveredDevices}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#ECF0F1"
                                            CornerRadius="6"
                                            Padding="15"
                                            Margin="0,0,0,10"
                                            Cursor="Hand">
                                        <Border.Styles>
                                            <Style Selector="Border:pointerover">
                                                <Setter Property="Background" Value="#D5DBDB"/>
                                            </Style>
                                        </Border.Styles>

                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <Border Grid.Column="0"
                                                    Background="#3498DB"
                                                    Width="50"
                                                    Height="50"
                                                    CornerRadius="25"
                                                    Margin="0,0,15,0">
                                                <TextBlock Text="ðŸ“±"
                                                           FontSize="24"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>

                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding DeviceName}"
                                                           FontSize="16"
                                                           FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding DeviceType}"
                                                           FontSize="12"
                                                           Foreground="#7F8C8D"
                                                           Margin="0,3,0,0"/>
                                            </StackPanel>

                                            <Button Grid.Column="2"
                                                    Content="Send Files"
                                                    Padding="12,6"
                                                    VerticalAlignment="Center"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <!-- Empty State -->
                    <StackPanel Grid.Row="1"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                IsVisible="{Binding !DiscoveredDevices.Count}">
                        <TextBlock Text="ðŸ”"
                                   FontSize="48"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,10"/>
                        <TextBlock Text="No devices found"
                                   FontSize="16"
                                   Foreground="#7F8C8D"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Make sure AirDrop is enabled on nearby devices"
                                   FontSize="12"
                                   Foreground="#95A5A6"
                                   HorizontalAlignment="Center"
                                   Margin="0,5,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Active Transfers Panel -->
            <Border Grid.Column="1"
                    BorderBrush="#BDC3C7"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="15"
                    Margin="10,0,0,0">
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0"
                               Text="Active Transfers"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Margin="0,0,0,15"/>

                    <ScrollViewer Grid.Row="1">
                        <ItemsControl ItemsSource="{Binding ActiveTransfers}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#E8F8F5"
                                            BorderBrush="#1ABC9C"
                                            BorderThickness="2"
                                            CornerRadius="6"
                                            Padding="12"
                                            Margin="0,0,0,10">
                                        <StackPanel>
                                            <TextBlock Text="{Binding SourceDevice.DeviceName}"
                                                       FontSize="14"
                                                       FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding Files.Count, StringFormat='{}{0} file(s)'}"
                                                       FontSize="12"
                                                       Foreground="#7F8C8D"
                                                       Margin="0,3,0,0"/>
                                            <TextBlock Text="{Binding Status}"
                                                       FontSize="11"
                                                       Foreground="#16A085"
                                                       Margin="0,3,0,0"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <!-- Empty State -->
                    <StackPanel Grid.Row="1"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                IsVisible="{Binding !ActiveTransfers.Count}">
                        <TextBlock Text="ðŸ“¦"
                                   FontSize="36"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,10"/>
                        <TextBlock Text="No active transfers"
                                   FontSize="14"
                                   Foreground="#7F8C8D"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#34495E" Padding="15,10">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10">
                    <Ellipse Width="10" Height="10"
                             Fill="{Binding IsDiscovering, Converter={StaticResource BoolToColorConverter}}"
                             VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding StatusMessage}"
                               Foreground="White"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <TextBlock Grid.Column="2"
                           Text="{Binding DiscoveredDevices.Count, StringFormat='Devices: {0}'}"
                           Foreground="#BDC3C7"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</Window>
